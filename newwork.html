<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.7.570/pdf.min.js"></script>
<style>
    /* DEFAULTS */
    :root {
        --bgcolor: #eee;
        --bordcolor: #92929246;
        --black: #111;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --bgcolor: #111;
            --black: #eee;
        }

        #logo {
            filter: invert(100%);
        }
    }

    body {
        background-color: var(--bgcolor);
        margin: 0px;

    }


    /* SNAP CONTAINER TEST */

    /* Container that holds all your sections */
    .snap-container {
        height: 100vh;
        /* Full height of the viewport */
        overflow-y: scroll;
        /* Allows vertical scrolling */
        scroll-snap-type: y mandatory;
        /* Enables vertical scroll snapping */
    }

    /* Each section */
    main {
        scroll-snap-align: start;
        /* Aligns the start edge of the section with the container's scroll snap boundary */
        /* Your existing styles for main */
    }


    /* NAVBAR */
    .navbar {
        top: 1vh;
        height: 4vh;
        display: grid;
        width: 100vw;
        /* border: 1px solid red; */
        grid-template-rows: 5vh;
        /* grid-template-columns: 20vw 10vw 60vw 9vw; */
        grid-template-columns: repeat(8, minmax(0, 1fr));
        padding: 2vh;
        position: fixed;
        font-size: 11px;
        text-transform: uppercase;
        font-family: modern-era-mono, monospace;
        z-index: 1001;
        color: white;
        mix-blend-mode: difference;
    }

    .navbar a {
        text-decoration: underline;
        cursor: pointer;
        color: var(--black);
        color: white;
        mix-blend-mode: difference;
    }


    .navbar>div {}

    .navbar>#nav0 {
        grid-column: 1;
    }

    .navbar>#nav1 {
        grid-column: 2;
    }

    .navbar>#nav2 {
        grid-column: 5;
    }

    .navbar>#nav3 {
        grid-column: 6;
    }

    .navbar>#nav4 {
        grid-column: 8;
    }



    /* Main pages */
    main {
        height: 100vh;
        width: 100vw;
        /* border: 1px solid black; */
        position: relative;
        display: flex;
    }


    #logo {
        position: absolute;
        /* border: 1px solid orange; */
        pointer-events: none;


        width: 60vw;
        height: auto;
        right: 0vw;
        bottom: 1vh;
    }

    main>#aboutme {
        color: var(--black);
        /* border: 1px solid salmon; */
        position: absolute;
        top: 7vh;
        left: 5vw;
        width: 45vw;
        font-size: 35px;
        font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    }


    /* terza pagina */
    #Thirdpage {
        /* All this just so that it expand based on the gallery items */
        display: flex;
        flex-wrap: wrap;
        overflow-x: auto;
    }


    #gallerymain {
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .gallery {
        position: absolute;
        top: 10vh;

        column-count: 3;
        column-gap: 5px;
        row-gap: 10px;
        width: 98vw;
        padding-left: 1vw;
        padding-right: 1vw;
    }

    .gallery img {
        width: 100%;
        height: auto;
        margin-top: 6px;
        cursor: pointer;
        filter: grayscale(100%);
    }

    /* modal test */

    /* The Modal (background) */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100vw;
        height: 100vh;
        overflow: auto;
        background-color: var(--bgcolor);
        align-items: center;
        justify-content: center;
    }

    /* Modal Content */
    /* .modal-content {
        position: relative;
        background-color: aqua;
        width: 70vw;
        overflow-y: auto;
    } */

    /* The Close Button */
    .close {
        color: #aaa;
        grid-column: 1;
        grid-row: 2;
        /* position: fixed; */
        /* bottom: 1vh;
        height: 4vh; */
        /* display: grid; */
        /* width: 100vw; */
        /* grid-template-columns: repeat(8, minmax(0, 1fr)); */
        /* padding: 2vh; */
        font-family: monospace;
        display: block;
        /* transform: rotate(+90deg); */
        margin-block-start: 1em;
        margin-block-end: 1em;
        pointer-events: all;

    }

    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }

    .modal-content {
        height: 30vh;
        display: grid;
        width: 100vw;
        /* border: 1px solid red; */
        grid-template-rows: repeat(2, minmax(0, 1fr));
        /* grid-template-columns: 20vw 10vw 60vw 9vw; */
        grid-template-columns: repeat(8, minmax(0, 1fr));
        padding: 2vh;
        font-size: 11px;
        font-family: modern-era-mono, monospace;
        z-index: 1001;
        color: white;
        /* mix-blend-mode: difference; */
        position: fixed;
        bottom: 20vh;
        pointer-events: none;
    }

    #modal-title {
        font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 90px;
        color: var(--black);
        grid-column: 2;
    }

    #modal-desc {
        color: var(--black);
        font-size: 11px;
        font-family: monospace;
        grid-column: 2;
    }

    #modal-info {
        color: var(--black);
        font-size: 11px;
        font-family: monospace;
        grid-column: 4;
    }





    .modal-imggallery {
        grid-row: 2;
        grid-column: 2;
        overflow-x: scroll;
        overflow-y: hidden;
        scroll-snap-type: x mandatory;
        display: flex;
        flex-wrap: nowrap;
        height: auto;
        width: 100%;
    }

    .imgcontainer {
        display: grid;
        grid-template-rows: 10vh 80vh 10vh;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        flex: 0 0 auto;
        overflow-y: hidden;
    }

    .modal img {
        scroll-snap-align: start;
        height: auto;
        width: 100%;
        margin-right: 20vw;
        object-fit: contain;
    }

    .modal-imggallery::-webkit-scrollbar {
        display: none;
    }



    /* Mobile responsive */
    @media(max-width: 800px) {
        #logo {
            position: absolute;
            pointer-events: none;


            width: 100vw;
            height: auto;
            right: 0vw;
            bottom: 15vh;
        }

        .navbar>#nav0 {
            display: "";
        }

        .navbar>#nav1 {}

        .navbar>#nav2 {
            display: none;
        }


        main>#aboutme {
            /* border: 1px solid salmon; */
            width: 80vw;
            font-size: 20px;
            padding-top: 10vh;
        }

        .gallery {
            column-count: 2;
            padding-top: 10vh;

        }


        /* modal responsive */
        .imgcontainer {
            grid-template-columns: 1fr;
            grid-template-rows: 10vh 50vh 40vh;
        }

        .modal-content {
            bottom: 10vh;
            grid-template-columns: repeat(4, minmax(0, 1fr));
        }

        #modal-desc {
            grid-column-end: 3;
        }

        .close {
            display: block;
        }


    }
</style>


<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>


<body>

    <nav class="navbar">
        <div id="nav0">LOGO</div>
        <div id="nav1">ALESSANDRO MAGNOCAVALLO <br> <a href="mailto:ale@magno.me">ale@magno.me</a></div>
        <div id="nav2">STUDENT <br>WEB DESIGNER <br>GRAPHIC DESIGNER</div>
        <div id="nav3">SOCIALS <br>LI IG</div>
        <div id="nav4">WRK</div>
    </nav>



    <div class="snap-container">
        <!-- First page -->
        <main id="Firstpage">
            <img src="images/logo.svg" id="logo">
        </main>


        <!-- Second page -->
        <main id="Secondpage">
            <p id="aboutme">
                My name is Alessandro Magnocavallo. I am currently
                advancing my academic pursuit in Communication Design at Politecnico di Milano.
                With a foundational interest in the realms of web and graphic design, my academic and project-based
                experiences have been dedicated to the exploration and mastery of visual communication. My approach is
                methodical, yet creative, aiming to merge aesthetic appeal with functional design to create intuitive
                and engaging digital experiences.
            </p>
        </main>


        <!-- terza pagina // works -->
        <main id="Thirdpage" id="gallerymain">
            <div class="gallery">
                <img src="works/01 - Olin/thumb.png" alt="" onclick="populateModal(projects[0])">
                <img src="works/02 - Typographic/thumb.png" alt="" onclick="populateModal(projects[1])">
                <img src="works/03 - Geppo Website/thumb.png" alt="" onclick="populateModal(projects[2])">
            </div>
        </main>


    </div>
    <!-- modal test, for descripted work -->

    <div id="myModal" class="modal">
        <div class="imgcontainer">


            <div class="modal-imggallery" id="modal-imggid">
                <img src="" alt="Gallery Image">
                <img src="" alt="">
            </div>
        </div>


        <div class="modal-content">

            <span class="close" onclick="closemodal()">CLOSE</span>
            <titolo id="modal-title">//01</titolo>

            <!-- You can add more content here if needed -->
            <p id="modal-desc">
                <b id="modal-v-title">Project name</b>
                <br><br><br>
                <span id="modal-v-desc">Quick little description</span>
                <br><br><br>
                Project Type: <br> <span id="modal-v-ptype"></span>
            </p>
            <p id="modal-info">
                Date made:
                <br>
                <span id="modal-v-date"></span>
                <br><br><br>
                Tools used: <br>
                <span id="modal-v-tools"></span>
            </p>
        </div>
    </div>

</body>


<script>

    window.onload = function () {
        // Hide the preloader
        console.log("loaded");
    };



    function closemodal() {
        // var btn = document.getElementById('myModal');
        // btn.style.display = "none";
        document.body.style.overflow = '';


        var modal = document.getElementById('myModal');
        modal.style.animation = 'fadeOutModal 0.2s forwards';
        setTimeout(() => {
            modal.style.display = 'none';
            modal.style.animation = 'fadeInModal 0.2s forwards';
        }, 200);
    }



    // hype shit ykyk
    const projects = [
        {
            number: "//01",
            name: "Olin Ski",
            description: "woow so cool man keep it up",
            ptype: "dsadsadasd",
            tools: "dsadad",
            date: "sdsadjasd",

            images: [],
            pdf: "./works/01 - Olin/document.pdf",
        },
        {
            number: "//02",
            name: "Project One",
            description: "This is the description for Project One.",
            ptype: "testptype",
            tools: "testtools",
            date: "000001",

            images: [],
            pdf: "./works/02 - Typographic/document.pdf",
        },
        {
            number: "//03",
            name: "Geppo's website",
            description: "This is the description for Project One.",
            ptype: "Website",
            tools: "vscode",
            date: "000001",

            images: ['./works/03 - Geppo Website/images/img1.png', './works/03 - Geppo Website/images/img2.png', './works/03 - Geppo Website/images/img3.png'],
            pdf: "",
        },
    ];



    function populateModal(project) {
        document.body.style.overflow = 'hidden';
        var btn = document.getElementById('myModal');
        btn.style.display = "block";
        const number = document.getElementById('modal-title');
        const title = document.getElementById('modal-v-title');
        const desc = document.getElementById('modal-v-desc');
        const ptype = document.getElementById('modal-v-ptype');
        const tools = document.getElementById('modal-v-tools');
        const date = document.getElementById('modal-v-date');
        const imageContainer = document.getElementById('modal-imggid'); // Make sure this ID matches your HTML

        // Clear previous images
        imageContainer.innerHTML = '';
        imageContainer.scrollLeft = 0;
        setTimeout(() => {
            imageContainer.scrollLeft = 0; // Reset the horizontal scroll position
        }, 500); // Adjust delay as necessary

        // Setting project information
        number.textContent = project.number;
        title.textContent = project.name;
        desc.textContent = project.description; // Ensure you have this element in your HTML
        ptype.textContent = project.ptype;
        tools.textContent = project.tools;
        date.textContent = project.date;

        // Iterate over each image URL in the project and create an <img> element
        project.images.forEach((imageUrl) => {
            const img = document.createElement('img');
            img.src = imageUrl;
            // Optionally add a class for styling. Ensure the class name matches your CSS.
            // img.classList.add('modal-imggallery');

            // Append the new img element to the container, not a string
            imageContainer.appendChild(img);
        });

        displayPdfAsImages(project.pdf);

    }



    async function displayPdfAsImages(pdfUrl) {
        const loadingTask = pdfjsLib.getDocument(pdfUrl);
        const pdf = await loadingTask.promise;
        const container = document.getElementById('modal-imggid'); // Your gallery container

        for (let pageNumber = 1; pageNumber <= pdf.numPages; pageNumber++) {
            const page = await pdf.getPage(pageNumber);

            // Create a canvas to render the page
            const canvas = document.createElement('canvas');
            const viewport = page.getViewport({ scale: 1 });
            canvas.height = viewport.height;
            canvas.width = viewport.width;

            // Render PDF page into canvas context
            const renderContext = {
                canvasContext: canvas.getContext('2d'),
                viewport: viewport
            };
            await page.render(renderContext).promise;

            // Convert canvas to an image and append to the gallery
            const img = document.createElement('img');
            img.src = canvas.toDataURL();
            container.appendChild(img);
        }
    }






</script>






<!-- Animations, or at least trying to -->
<style>
    /* Additions for modal animations */
    .modal {
        animation: fadeInModal 0.2s forwards;

    }

    @keyframes fadeInModal {
        from {
            opacity: 0;
        }

        to {
            opacity: 1;
        }
    }

    @keyframes fadeOutModal {
        from {
            opacity: 1;
        }

        to {
            opacity: 0;
        }
    }

    .modal img {
        animation: slideIn 0.5s ease-out;
    }
</style>